# PRD v1（评审草案）
## 项目
T-20260211-100 学习成长系统重构（学生端 + 家长端）

## 审查索引（快速定位）
- PRD→模块：见 **3. 功能模块拆解**（3.1~3.5）
- PRD→数据结构：见 **4. 数据结构草案**（`profile_v1/plan_v4/timer_v2/checkin_v2/supervision_v1/points_v1/score_v1`）
- PRD→权限矩阵：见 **2. 用户与权限矩阵**
- PRD→监督策略：见 **5. 监督策略（可执行规则）**
- PRD→A/B测试点：见 **6. A/B测试点**
- PRD→里程碑排期：见 **7. 里程碑排期（评审版）**

## 1. 目标与范围
### 1.1 目标
- 让孩子“看得见进步、做得到计划、做得到自律、拿得到激励”。
- 让家长“可配置、可监督、可审核、可追溯”。

### 1.2 本期范围（MVP+）
1) 学习看板：学科进度/成绩/作业完成图表
2) 计划与执行：20/30天计划 + 每日任务
3) 监督机制：计时 + 随机在岗验证 + 拍照提交 + 家长审核
4) 积分奖惩：积分账户 + 兑换商城 + 奖惩流水
5) 成长档案：身高体重/照片/里程碑

### 1.3 不在本期
- AI自动批改主观题（先人工审核）
- 硬件摄像头持续监控（仅做可选提醒与随机验证）

---

## 2. 用户与权限矩阵
| 角色 | 查看学习数据 | 制定/改计划 | 开始/结束计时 | 提交作业 | 审核作业 | 配置监督规则 | 配置积分商城 | 管理成长档案 |
|---|---|---|---|---|---|---|---|---|
| 学生 | ✅ | 仅提案（需家长确认） | ✅ | ✅ | ❌ | ❌ | ❌ | 仅查看 |
| 家长 | ✅ | ✅ | ✅（代操作） | ✅（代提交） | ✅ | ✅ | ✅ | ✅ |

关键控制：
- 学生端无“系统配置”入口。
- 家长端可强制计划锁定（锁定后学生不可改）。

---

## 3. 功能模块拆解
## 3.1 学习看板（学生端/家长端）
- 指标：
  - 学科完成率（本周/本月）
  - 成绩趋势（折线）
  - 作业完成及时率（柱状）
  - 错题改正率（环形）
- 图表建议：ECharts（折线/柱状/雷达/环形）

## 3.2 计划与执行
- 计划粒度：假期总计划（20/30天）+ 日计划（任务清单）
- 规则：
  - 每日任务上限（家长配置）
  - 未完成自动顺延
  - 计划变更要留痕（谁、何时、改了什么）

## 3.3 监督机制
- 计时：开始/暂停/继续/结束，记录有效学习时长
- 随机在岗验证（反摸鱼）：
  - 启动后按随机间隔弹验证（如 8~15 分钟）
  - 验证形式：小题目/知识点判断/简短打字确认
  - 规则：超时未响应记“可疑离岗”
- 拍照提交：作业完成拍照 + 备注
- 家长审核：通过/驳回 + 批注 + 要求重做

## 3.4 积分奖惩与商城
- 积分来源：按时完成、连续打卡、成绩提升、优秀行为
- 扣分来源：拖延、未按时提交、审核驳回后未整改
- 商城：
  - 小奖励：看电视30分钟、游戏20分钟、美食券
  - 大奖励：周末外出、目标达成礼物
- 兑换流程：学生发起 -> 家长审批 -> 核销

## 3.5 成长档案
- 基础：年龄、年级、身高、体重
- 里程碑：获奖/进步事件/改错记录
- 相册：学习与生活照片（按月展示）

---

## 4. 数据结构草案（前端 localStorage 命名，可平滑迁移后端）
```json
profile_v1: {
  "student": {"nameMasked":"路*昊","age":10,"grade":"四年级"},
  "growth": {"heightCm":140,"weightKg":34,"updatedAt":""}
}

plan_v4: {
  "cycleDays": 20,
  "dailyCap": 4,
  "lockedByParent": true,
  "days": [
    {"day":1,"tasks":[{"id":"t1","subject":"数学","title":"...","status":"todo|done|review_reject"}]}
  ],
  "changeLogs": [{"by":"parent|student","at":"","diff":"..."}]
}

timer_v2: {
  "sessions": [
    {"taskId":"t1","subject":"数学","startAt":"","endAt":"","activeMs":1800000,"interruptions":1}
  ]
}

checkin_v2: {
  "items": [
    {"taskId":"t1","photo":"dataURL","note":"","submittedAt":"","review":"pending|approved|rejected","reviewNote":""}
  ]
}

supervision_v1: {
  "rules": {"enabled":true,"minGapMin":8,"maxGapMin":15,"timeoutSec":60},
  "events": [
    {"sessionId":"s1","type":"challenge","shownAt":"","answered":true,"latencySec":18,"result":"pass|fail|timeout"}
  ]
}

points_v1: {
  "balance": 120,
  "ledger": [{"at":"","delta":10,"reason":"按时完成日计划"}],
  "shop": [{"id":"r1","name":"看电视30分钟","cost":30,"enabled":true}],
  "orders": [{"id":"o1","rewardId":"r1","status":"pending|approved|rejected|redeemed"}]
}

score_v1: {
  "records": [{"subject":"数学","score":92,"at":"","source":"周测"}],
  "mistakeFix": [{"mistakeId":"m1","fixed":true,"verifiedByParent":true}]
}
```

---

## 5. 监督策略（可执行规则）
1) 学习会话进入后即启动随机验证池。
2) 连续2次超时未响应：本次会话标记“低可信”，该时段不计奖励分。
3) 拍照提交 + 家长审核通过，才算任务最终完成。
4) 审核驳回后24小时未整改：自动扣分并加入提醒。

---

## 6. A/B测试点（先小流量验证）
- A/B-1：随机验证频率
  - A: 8~12分钟；B: 12~18分钟
  - 观察：有效学习时长、打断反感率
- A/B-2：奖励发放方式
  - A: 即时小奖；B: 周结大奖
  - 观察：连续完成率、拖延率
- A/B-3：计划生成方式
  - A: 系统自动分配；B: 学生提案+家长确认
  - 观察：计划执行率、临时变更率

---

## 7. 里程碑排期（评审版）
- M1（D1-D2）：信息架构/权限框架/数据模型落地
- M2（D3-D4）：计划执行+计时+拍照提交+家长审核主链路
- M3（D5）：学习看板图表 + 积分账本 + 商城兑换
- M4（D6）：成长档案 + A/B开关 + 验收与证据包

交付物：
- PRD v1（本文件）
- 页面原型草图（下一轮）
- API草案（若切后端）
